# Task

This is a fresh project ( no code ).

We are in specifications period.

I already made the following BMAD workflows:
- brainstorm
- Product Brief
- UI-UX
- Now in the middle of architecture

We brainstorm on new ideas/changes to operate on the current state. Then I will use `/bmad:bmm:workflows:correct-course`

## Idea 1: Spawn Child

Modification on how spawn claude code child process.

We are going to use the stream mode from claude code to manage conversation from within the session.

About the session ID there is 2 approach:

1. Control session ID with DB:

We will manage the session ID ourself. When start a new Session, we generate the ID and initiate the stream by specifying the ID, so we can start again from there at next launch, we saved the ID.

2. When the APP start we can the existing session in .claude folder to load the menu listing. So we got all the existing session and their creation time from .claude folder, avoid to use DB. When create new session, we provide the session ID to visually connect it, but we dont save it since we refresh the list at each start and a session can only be created from the app because the .claude used is isolated for the app only.

I need to decide between both.

So, Instance refer to a process we started with claude code, running.

It will works as follow:

I don't know how we will manage the instances. Probably when the APP start, no instance running. when start a session, it connect a stream. If discuss in another session, we will have 2 running session. We will add visual element to distinguiss it ( see UI/UX below ). We also need to stop them maybe 3 minute after being in 'pending' status.

The 'pending' status means that the instance have finish to answer and is just waiting for user input. After 3 minutes in this state we stop the instance. If the user type in the session input box of a running instance, it reset the total time 'pending' and go for another 3 minutes. The total time can be set in the settings, its possible to set 0 for always open. In that case in the sessions list, a button appear, to disconnect the stream. The icon remind of disconnecting something.

We will have to do a research on claude code stream feature and best practice to know how to implement it.

---

About the UI/UX.

In the list of sessions on the left panel.

- A session with an instance working (not pending) appear with an icon `...` slowly blinking to indicate its working.
- A session that just finish to work ( the instance become 'pending' ), display a red dot notification, until the session is focused on the middle panel (the user view the result). The dot disapear by itself after 2 seconds if the middle panel is already focusing this session.
- A whello warning sign appear when a bug occurs, until the session is focused