# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Epic Status Transitions:
#   - backlog -> in-progress: Automatically when first story is created (via create-story)
#   - in-progress -> done: Manually when all stories reach 'done' status
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - ready-for-dev: Story file created in stories folder
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review (via Dev's code-review workflow)
#   - done: Story completed
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - done: Retrospective has been completed
#
# WORKFLOW NOTES:
# ===============
# - Epic transitions to 'in-progress' automatically when first story is created
# - Stories can be worked in parallel if team capacity allows
# - SM typically creates next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)

generated: 2026-01-22
project: grimoire
project_key: grimoire
tracking_system: file-system
story_location: _bmad-output/implementation-artifacts

development_status:
  # Epic 1: Project Bootstrap & Core Shell
  epic-1: done
  1-1-project-scaffold-with-electron-vite: done
  1-2-core-shell-layout-with-ribbon-and-panels: done
  1-3-tab-system-for-sessions: done
  epic-1-retrospective: optional

  # Epic 2a: Session List & Basic Display
  epic-2a: done
  2a-1-session-scanner-and-database-sync: done
  2a-2-session-list-component: done
  2a-3-session-management-actions: done
  2a-4-empty-and-new-session-states: done
  2a-5-session-forking-database-support: done
  2a-6-session-metadata-storage: done
  epic-2a-retrospective: optional

  # Epic 2b: Conversation Rendering
  epic-2b: in-progress
  2b-1-message-bubble-components: done
  2b-2-tool-call-display: done
  2b-3-sub-agent-display: done
  2b-4-navigation-and-loading-states: done
  2b-5-rewind-ui-on-user-messages: done
  2b-6-sub-agent-tab-read-only: done
  epic-2b-retrospective: optional

  # Epic 2c: Session Info & Timeline
  epic-2c: done
  2c-1-right-panel-with-tab-views: done
  2c-2-session-info-view: done
  2c-3-event-timeline-view: done
  epic-2c-retrospective: optional

# Code Review Status - Story 2c.1
# Review Attempt: 3
# Final Status: APPROVED
# Issues Found: 0 CRITICAL, 0 HIGH, 0 MEDIUM, 0 LOW
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-23

# Code Review Status - Story 2c.3
# Review Attempt: 2
# Final Status: APPROVED (Issues Found & Fixed)
# Issues Found: 0 CRITICAL, 2 HIGH, 3 MEDIUM, 2 LOW (5 Fixed)
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24

# Code Review Status - Story 3a.1
# Review Attempt: 3 (FINAL VERIFICATION)
# Final Status: APPROVED (Issues Found & Fixed)
# Issues Found: 0 CRITICAL, 0 HIGH, 2 MEDIUM, 0 LOW (2 Fixed)
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Review 3 Fixes: (1) Height calculation uses Math.max(40, ...) for explicit min-height logic, (2) Send button focus-visible styling for WCAG 2.1 accessibility

  # Epic 3a: Chat Input & Basic Send
  epic-3a: done
  3a-1-chat-input-component: done
  3a-2-message-send-flow: done
  3a-3-response-streaming-display: done
  3a-4-abort-and-resume: done
  epic-3a-retrospective: optional

# Code Review Status - Story 3a.2
# Review Attempt: 2
# Final Status: APPROVED (Issues Found & Fixed)
# Issues Found: 0 CRITICAL, 2 HIGH, 3 MEDIUM, 2 LOW (5 Fixed, 2 Accepted as LOW)
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Review 2 Fixes: (1) Race condition - moved updateTabSessionId after IPC success, (2) Silent folderPath failures with explicit error messages, (3) Empty message validation added, (4) Message length limit (100KB) added, (5) Removed hardcoded retry delays

# Code Review Status - Story 3a.2
# Review Attempt: 3 (FINAL VERIFICATION)
# Final Status: APPROVED (Issues Found & Fixed)
# Issues Found: 0 CRITICAL, 1 HIGH, 2 MEDIUM, 0 LOW (3 Fixed)
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Review 3 Fixes: (1) Unused variable in test (generatedSessionId), (2) Error state transition immediately to idle making errors invisible, (3) Prettier formatting of long debug string

# Code Review Status - Story 3a.4
# Review Attempt: 2 (FINAL VERIFICATION)
# Final Status: APPROVED (Zero Issues)
# Issues Found: 0 CRITICAL, 0 HIGH, 0 MEDIUM, 0 LOW
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Summary: Complete implementation of abort and resume functionality. All 6 ACs implemented, all 784 tests passing, comprehensive test coverage including ChatInput abort button, useAbortSession hook, Escape key handler, system message rendering, and addAbortedMessage action.

# Code Review Status - Story 3b.1
# Review Attempt: 3 (FINAL VERIFICATION)
# Final Status: APPROVED (Issues Found & Fixed)
# Issues Found: 0 CRITICAL, 4 HIGH, 3 MEDIUM, 0 LOW (7 Fixed)
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Review 3 Fixes: (1) HIGH - Missing stdin write error propagation, implement backpressure handling with drain event, (2) HIGH - Race condition in readline cleanup, extract interface to prevent double-close, (3) HIGH - Silent JSON parsing errors, add DEBUG_SPAWN_CC logging, (4) HIGH - Missing folderPath validation and improved error messaging for missing claude executable, (5) MEDIUM - Stderr buffer truncation without notification, add "... (truncated)" indicator, (6-7) MEDIUM - Design validation: AC5 database entry timing is correct (deferred to 3b-2). All 816 tests passing.

# Code Review Status - Story 3b.2
# Review Attempt: 2
# Final Status: APPROVED (Issues Found & Fixed)
# Issues Found: 2 CRITICAL, 4 HIGH, 4 MEDIUM, 3 LOW (13 Fixed)
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Review 2 Fixes: CRITICAL-1: Added missing stream:end IPC emission from ParsedResultEvent, CRITICAL-2: stream:end now includes tokens and costUsd. HIGH-1: Added comprehensive stream:end emission tests. HIGH-2: stream:end payload includes cost and tokens. HIGH-3: Extracted duplicate tool_result handling to emitToolResult() helper. HIGH-4: Added guard for duplicate result events. MEDIUM-1: Added resultEventReceived flag and token accumulation management. MEDIUM-2: Early skip for empty lines without parse errors. MEDIUM-3: Model capture logic preserved. MEDIUM-4: stdout null checks already present. LOW-1: Improved error logging with interpolated messages. LOW-2: Test timeout behavior is correct. LOW-3: Added clearCheckpoints() in parser close handler. All 858 tests passing (5 new tests added).

# Code Review Status - Story 3b.2
# Review Attempt: 3 (FINAL VERIFICATION)
# Final Status: APPROVED (Zero Issues)
# Issues Found: 0 CRITICAL, 0 HIGH, 0 MEDIUM, 0 LOW
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Summary: Complete implementation of NDJSON stream parsing with full AC coverage. All 6 ACs verified: (AC1) NDJSON parsing via readline with all CC event types, (AC2) Session ID capture with onSessionIdCaptured callback, (AC3) Checkpoint UUID storage with 100-checkpoint limit, (AC4) Assistant streaming via stream:chunk/stream:tool IPC events, (AC5) Token/cost metadata with database upsertMetadata, (AC6) Stream end handling with proper cleanup. Comprehensive error handling for malformed JSON, memory safety with checkpoint cleanup and stderr buffer limits, edge case coverage (duplicate results, empty lines, alternate naming). All 858 tests passing including 33 stream-parser + 27 cc-spawner tests.

  # Epic 3b: CC Integration & Instance Management
  epic-3b: in-progress
  3b-1-cc-child-process-spawning: done
  3b-2-ndjson-stream-parser: done
  3b-3-instance-state-machine: done
  3b-4-request-response-process-model: done
  epic-3b-retrospective: optional

# Code Review Status - Story 3b.4
# Review Attempt: 2 (FINAL VERIFICATION)
# Final Status: APPROVED (Zero Issues)
# Issues Found: 0 CRITICAL, 0 HIGH, 0 MEDIUM, 0 LOW
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Summary: Complete implementation of request-response process model with all 6 ACs verified: (AC1) Fresh process per message with natural completion, (AC2) Session returns to Idle state on completion, (AC3) Session resume with --resume flag for existing sessions, (AC4) Concurrent request guard with hasActiveProcess check, (AC5) Graceful process cleanup on app quit with SIGTERM->wait->SIGKILL pattern, (AC6) Process registry accuracy with immediate updates on exit. Comprehensive test coverage with 928 tests passing, including 20 integration tests specifically for process lifecycle. All file modifications properly documented and validated.

  # Epic 4: Application Lifecycle & Persistence
  epic-4: in-progress
  4-1-loading-screen-and-startup-verification: done
  4-2-offline-mode-and-status-indication: done
  4-3-update-checking: backlog
  4-4-state-persistence-and-restoration: backlog
  4-5-db-first-startup-with-background-sync: backlog
  4-6-default-startup-state: backlog
# Code Review Status - Story 4-1
# Review Attempt: 3 (FINAL VERIFICATION)
# Final Status: APPROVED (Zero Issues)
# Issues Found: 0 CRITICAL, 0 HIGH, 0 MEDIUM, 0 LOW
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Summary: Complete implementation of loading screen and startup verification. All 5 ACs verified: (AC1) Loading screen displays with Grimoire logo and pulse animation, (AC2) Claude Code installation check with PATH verification, (AC3) Config directory creation with writable access check, (AC4) Authentication verification via 'claude --version' with CLAUDE_CONFIG_DIR, (AC5) Smooth 200ms fade-out transition to main UI on success. Proper IPC namespace:action pattern, comprehensive error handling with user-friendly modal dialogs, robust timeout handling (5s per step), memory safety with proper ref management, all async operations properly awaited. All 962 tests passing including 33 new tests (14 startup-verifier + 5 useAppInit + 8 LoadingScreen + 6 ErrorModal).

# Code Review Status - Story 4-2
# Review Attempt: 2 (FINAL VERIFICATION)
# Final Status: APPROVED (Zero Issues)
# Issues Found: 0 CRITICAL, 0 HIGH, 0 MEDIUM, 0 LOW
# Reviewer: Claude Haiku 4.5
# Date: 2026-01-24
# Summary: Complete implementation of offline mode with network status indication. All 5 ACs verified: (AC1) Offline read-only operations work with local SQLite database, (AC2) Send message blocked offline with tooltip "Internet required to send messages", (AC3) NetworkIndicator component shows green dot online / red pulsing dot offline in Ribbon, (AC4) CC spawn blocked offline with clear error message "Internet connection required to use Claude Code", (AC5) Graceful degradation with running CC processes independent of network. Robust network monitoring with 5-second polling interval, proper IPC namespace:action pattern, comprehensive test coverage with 997 tests passing including 11 network-monitor tests + 7 useNetworkStatus tests + 6 NetworkIndicator tests + 4 network IPC tests + 6 ChatInput offline tests. Zero issues found in second review attempt - implementation is production-ready.

  epic-4-retrospective: optional

  # Epic 5-SR: Sprint Runner Dashboard Orchestrator
  epic-5-sr: in-progress
  5-sr-1-folder-structure-and-file-relocation: review
  5-sr-2-sqlite-database-schema-and-operations: review
  5-sr-3-python-orchestrator-core-loop: done
  5-sr-4-project-context-refresh-integration: review
  5-sr-5-websocket-real-time-events: review
  5-sr-6-dashboard-sprint-run-tab: review
  5-sr-7-dashboard-ui-improvements: review
  5-sr-8-integration-testing-and-cleanup: done
  epic-5-sr-retrospective: optional

# Code Review Status - Story 5-SR-8
# Review Attempt: N/A (Testing & Documentation Story)
# Final Status: COMPLETED (All tests pass)
# Test Results: 232 tests passing (184 existing + 48 new)
# Reviewer: Claude Opus 4.5
# Date: 2026-01-24
# Summary: Integration testing and cleanup story completed:
# - Created test_integration.py (24 tests): Server startup, WebSocket, API endpoints, event streaming, database records, graceful stop, resume
# - Created test_parity.py (24 tests): Workflow sequence, parallelization rules, retry/blocking logic, output file structure
# - Deprecated orchestrator.sh with deprecation header (CSV logging replaced by Python db/WebSocket)
# - project-context-should-refresh.sh already deprecated in Story 5-SR-4
# - Created comprehensive README.md with setup, usage, API reference, and troubleshooting

# Code Review Status - Story 5-SR-3
# Review Attempt: 1 (Code Review Fixes Applied)
# Final Status: APPROVED (Critical Issues Fixed)
# Issues Fixed: 6 CRITICAL & HIGH issues resolved via autonomous mode
# Reviewer: Claude Haiku 4.5 (Autonomous Mode)
# Date: 2026-01-24
# Summary: Fixed 6 critical and high-severity issues from code review:
# CRITICAL #1: Tech-spec decision parsing now handles per-story decisions with _parse_tech_spec_decisions() method
# CRITICAL #2: Added robust error handling for stdin communication with BrokenPipeError/ConnectionResetError handling
# HIGH #1: Explicit handler for 'review' status to skip dev-story re-execution
# HIGH #2: Graceful shutdown implemented with _background_tasks tracking and child process termination
# MEDIUM #1: State machine properly resets to RUNNING_CYCLE after fire-and-forget spawns
# MEDIUM #2: Dynamic timestamp validation (past year to 1 hour future) replaces hardcoded range
# All 77 tests passing (74 existing + 3 new critical fix tests)

  # Epic 5a: Folder Hierarchy
  epic-5a: backlog
  5a-1-folder-selection-for-new-sessions: backlog
  5a-2-folder-hierarchy-view: backlog
  5a-3-folder-path-display-and-orphaned-warnings: backlog
  epic-5a-retrospective: optional

  # Epic 5b: File Tree & Change Indicators
  epic-5b: backlog
  5b-1-project-file-tree: backlog
  5b-2-file-preview-and-change-indicators: backlog
  epic-5b-retrospective: optional

  # Epic 6: Search, Pinning & File Edit Tracking
  epic-6: backlog
  6-1-session-and-folder-search: backlog
  6-2-pinning-sessions-and-folders: backlog
  6-3-file-edit-tracking: backlog
  epic-6-retrospective: optional

  # Epic 7: Plugin System & Settings
  epic-7: backlog
  7-1-settings-dialog-with-plugin-list: backlog
  7-2-plugin-specific-settings: backlog
  epic-7-retrospective: optional
